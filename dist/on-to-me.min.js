export function getPreviousSib(t){let e=t;for(;e&&e.hasAttribute("on");)e=e.previousElementSibling,null===e&&(e=t.parentElement);return e}export function nudge(t){const e=t.getAttribute("disabled");null!==e&&(0===e.length||"1"===e?t.removeAttribute("disabled"):t.setAttribute("disabled",(parseInt(e)-1).toString()))}export function getProp(t,e,n){let o=t,s=!0;return e.forEach((t=>{if(o&&""!==t){if(s&&"target"===t&&null===o.target)o=n._trigger;else switch(typeof t){case"string":o=o[t];break;default:o=o[t[0]].apply(o,t[1])}s=!1}})),o}const ltcRe=/(\-\w)/g;export function lispToCamel(t){return t.replace(ltcRe,(function(t){return t[1].toUpperCase()}))}export function findMatches(t,e,n,o,s){const l=[],r=null==n?1/0:parseInt(n);let i=0;for(t=o?t.closest(o):t.nextElementSibling;null!==t;){if(t.matches(e)){if(s){const e=Array.from(t.querySelectorAll(s));l.concat(e),i+=e.length}else i++,l.push(t);if(i>r)break}t=t.nextElementSibling}return l}export function getToProp(t,e){const n=(e||t).lastIndexOf("[");return-1===n?null:lispToCamel(t.substring(n+2,t.length-1))}export function passVal(t,e){const n=e("to"),o=e("care-of"),s=findMatches(this,n,e("me"),e("from"),o),l=getToProp(n,o);s.forEach((e=>{e[l]=t}))}export class OnToMe extends HTMLElement{connectedCallback(){this.style.display="none";const t=getPreviousSib(this);nudge(t);const e=this.getAttribute.bind(this);t.addEventListener(e("on"),(t=>{t.stopPropagation();const n=getProp(t,e("val")?.split("."),this);void 0!==n&&passVal(n,e)}));const n=e("init-val");if(null!==n){passVal(getProp(t,n.split("."),this),e)}}}const otm="on-to-me";customElements.get(otm)||customElements.define(otm,OnToMe);
