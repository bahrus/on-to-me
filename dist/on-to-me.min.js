export function getPreviousSib(t){let e=t;for(;e&&e.hasAttribute("on");)e=e.previousElementSibling,null===e&&(e=t.parentElement);return e}export function nudge(t){const e=t.getAttribute("disabled");null!==e&&(0===e.length||"1"===e?t.removeAttribute("disabled"):t.setAttribute("disabled",(parseInt(e)-1).toString()))}export function getProp(t,e,n){let o=t,r=!0;return e.forEach((t=>{if(o&&""!==t){if(r&&"target"===t&&null===o.target)o=n._trigger;else switch(typeof t){case"string":o=o[t];break;default:o=o[t[0]].apply(o,t[1])}r=!1}})),o}const ltcRe=/(\-\w)/g;export function lispToCamel(t){return t.replace(ltcRe,(function(t){return t[1].toUpperCase()}))}export function findMatches(t,e,n,o,r){const i=[],l=null==n?1/0:parseInt(n);let s=0;for(t=o?t.closest(o):t.nextElementSibling;null!==t;){if(t.matches(e)){if(r){const e=Array.from(t.querySelectorAll(r));i.concat(e),s+=e.length}else s++,i.push(t);if(s>l)break}t=t.nextElementSibling}return i}export function getToProp(t,e){const n=(e||t).lastIndexOf("[");return-1===n?null:lispToCamel(t.substring(n+2,t.length-1))}export class OnToMe extends HTMLElement{connectedCallback(){this.style.display="none";const t=getPreviousSib(this);nudge(t);const e=this.getAttribute.bind(this);t.addEventListener(e("on"),(t=>{t.stopPropagation();const n=getProp(t,e("val").split("."),this);if(void 0===n)return;const o=e("to"),r=e("care-of"),i=findMatches(this,o,e("m"),e("from"),r),l=getToProp(o,r);i.forEach((t=>{t[l]=n}))}))}}customElements.define("on-to-me",OnToMe);
