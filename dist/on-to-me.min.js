export function getPreviousSib(t){let e=t;for(;e&&e.hasAttribute("on");)e=e.previousElementSibling||t.parentElement;return e}export function nudge(t){const e=t.getAttribute("disabled");null!==e&&(0===e.length||"1"===e?t.removeAttribute("disabled"):t.setAttribute("disabled",(parseInt(e)-1).toString()))}export function getProp(t,e,n){let s=t,o=!0;return e.forEach((t=>{if(s&&""!==t){if(o&&"target"===t&&null===s.target)s=n._trigger;else switch(typeof t){case"string":s=s[t];break;default:s=s[t[0]].apply(s,t[1])}o=!1}})),s}const ltcRe=/(\-\w)/g;export function lispToCamel(t){return t.replace(ltcRe,(function(t){return t[1].toUpperCase()}))}export function findMatches(t,e,n,s,o){const i=[],l=null==n?1/0:parseInt(n);let r=0;for(t=s?t.closest(s):t.nextElementSibling;null!==t;){if(t.matches(e)){if(o){const e=Array.from(t.querySelectorAll(o));i.concat(e),r+=e.length}else r++,i.push(t);if(r>l)break}t=t.nextElementSibling}return i}export function getToProp(t,e){const n=(e||t).lastIndexOf("[");return-1===n?null:lispToCamel(t.substring(n+2,t.length-1))}export function passVal(t,e){const n=e("to"),s=e("care-of"),o=findMatches(this,n,e("me"),e("from"),s),i=getToProp(n,s);o.forEach((e=>{e[i]=t}))}export class OnToMe extends HTMLElement{connectedCallback(){this.style.display="none";const t=getPreviousSib(this);nudge(t);const e=this._g=this.getAttribute.bind(this);t.addEventListener(e("on"),(t=>{t.stopPropagation(),this._lastEvent=t,this.handleEvent()}));const n=e("mutate-event");null!==n&&this.parentElement?.addEventListener(n,(t=>{this.handleEvent()}));const s=e("init-val");if(null!==s){passVal(getProp(t,s.split("."),this),e)}}handleEvent(){const t=getProp(this._lastEvent,this._g("val")?.split("."),this);void 0!==t&&passVal(t,this._g)}}const otm="on-to-me";customElements.get(otm)||customElements.define(otm,OnToMe);
